#Intrusion Detection [ETC: XX Hours]
##Introduction
###Overview
In this module, we will be learning and using Snort, a free an open source network intrusion prevention system and network intrusion detection system. The set-up of snort is difficult and you should have a good understanding of linux package installations, file locations, etc. before you begin.
###Getting Started
To get started, you can install Snort with a package. 
~~~
#apt-get install snort-mysql
~~~
A installation wizard will start.

Enter the following settings:
~~~
#any
#no
~~~

Once installed, we will need to configure the SQL Database.

First, add a password for the MySQL root user.
~~~
#mysqladmin -u root password new_root_Password
~~~
then
Create the MySQL database and tables in order to recieve the Snort logs.
~~~
#mysql -u root -p
>create database snort;
~~~
Because it is not safe to access the database with the root user, we need to create a user who has only permission on the snort database:
~~~
>grant all on snort.* snortuser@localhost identified by 'snortpassword';
>flesh privileges;
>exit;
~~~
Find the tables: dpkg -L snort-mysql
We want to find the create_mysql.gz file. It is normally located under  /usr/share/doc/snort-mysql.
Unzip:
~~~
#gzip –d /usr/share/doc/snort-mysql/create_mysql.gz
~~~
Import the MySql tables:
~~~
#mysql -u root -p snort < /usr/share/doc/snort-mysql/create_mysql
~~~

Now, we need to configure Snort for SQL.
We want to forward the logs into the MySql database:
This is already done by installing the snort-mysql package, we just need only to configure the username and password to access the snort database.
In the /etc/snort/snort.conf file, we have to change the line between (#DBSTART#) and (#DBEND#):
~~~
output database: log, mysql, user=snortuser password=snortpassword dbname=snort host=localhost
~~~
In addition, uncomment the lines:
~~~
ruletype redalert
{
type alert
output alert_syslog: LOG_AUTH LOG ALERT
output database: log, mysql, user=snortuser password=snortpassword dbname=snort host=localhost
}
~~~

Start Snort!
~~~
snort –u snort –c /etc/snort/snort.conf
~~~
You should see the Snort banner, if not... Read the error message and Google for help.

We can add a line to crontab to start Snort atuomatically at boot:
inside /etc/crontab file, add:
~~~
@reboot root snort -u snort -c /etc/snort/snort.conf >> /dev/null
~~~

##Using Snort
###Understanding logs.
[BASE](http://base.secureideas.net/) is a graphical interface used to display the logs generated by Snort IDS. 

####Setting up BASE
 






